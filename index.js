(function(R,s,p,t,h,g,i,m,v,E){"use strict";const F=p.findByProps("openLazy","hideActionSheet"),{FormRow:$,FormIcon:T}=i.Forms,_=/^```(?:json)\n([\s\S]*?)```$/gm,x=g.getAssetIDByName("ic_download_24px");function A(){return h.before("openLazy",F,function(n){let[c,e]=n;e==="MessageLongPressActionSheet"&&c.then(function(r){const o=h.after("default",r,function(f,l){let[{message:te}]=f;t.React.useEffect(function(){return function(){o()}},[]);const y=te.content.match(_)?.map(function(a){return a.slice(7,a.length-3)}).map(function(a){try{return JSON.parse(a)}catch{return}}).filter(function(a){return a}).filter(function(a){return typeof a.name=="string"&&a.name&&typeof a.match=="string"&&typeof a.replace=="string"&&typeof a.flags=="string"&&typeof a.regex=="boolean"});if(!y||y.length==0)return;let ne=l?.props?.children?.props?.children?.props?.children[1];for(const a of y){const re=function(){s.storage.rules.push(a),m.showToast(`Imported rule ${a.name}`,x),F.hideActionSheet()},ae=t.React.createElement($,{leading:t.React.createElement(T,{style:{opacity:1},source:x}),label:`Import ${a.name}`,onPress:re});ne.unshift(ae)}})})})}const D=p.findByProps("sendMessage","receiveMessage"),L=g.getAssetIDByName("ic_warning_24px");function M(){return h.before("sendMessage",D,function(n){const c=s.storage.rules.filter(function(r){return r.match});let e=n[1].content;for(const r of c)if(r.regex)try{const o=new RegExp(r.match,r.flags);e=e.replace(o,r.replace)}catch(o){console.log(o),m.showToast(`Failed to use RegExp for ${r.name}!`,L);continue}else e=e.replaceAll(r.match,r.replace);n[1].content=e})}const{TouchableOpacity:B}=i.General,{FormIcon:O}=i.Forms,V=g.getAssetIDByName("ic_add_24px");function j(n){let{onPress:c}=n;return React.createElement(B,{onPress:c},React.createElement(O,{source:V,style:{marginRight:-8,marginLeft:8,opacity:1}}))}const{ScrollView:z}=i.General,{FormSection:u,FormInput:d,FormDivider:N,FormSwitchRow:G,FormRow:b,FormLabel:U}=i.Forms,H=g.getAssetIDByName("ic_message_copy"),J=t.stylesheet.createThemedStyleSheet({delete:{color:E.rawColors.RED_400}});function w(n){let{ruleIndex:c}=n,e=s.storage.rules[c];v.useProxy(s.storage);const r=t.NavigationNative.useNavigation(),o=function(){const l=`\`\`\`json
${JSON.stringify(e,null,4)}
\`\`\``;t.clipboard.setString(l),m.showToast(`Copied ${e.name} to Clipboard`,H)},f=function(){s.storage.rules.splice(c,1),r.pop()};return React.createElement(z,null,React.createElement(u,null,React.createElement(d,{value:e?.name,onChange:function(l){return e.name=l},placeholder:"New rule",title:"Name"})),React.createElement(u,null,React.createElement(d,{value:e?.match,onChange:function(l){return e.match=l},placeholder:"foo",title:"Match"}),e?.regex&&React.createElement(React.Fragment,null,React.createElement(N,null),React.createElement(d,{title:"Flags",placeholder:"gi",value:e?.flags,onChange:function(l){return e.flags=l}})),React.createElement(N,null),React.createElement(d,{value:e?.replace,onChange:function(l){return e.replace=l},placeholder:"bar",title:"Replace with"})),React.createElement(u,null,React.createElement(G,{label:"Regular expression",subLabel:"Turn on if your rule is a regular expression",value:e?.regex,onValueChange:function(l){return e.regex=l}})),React.createElement(u,null,React.createElement(b,{label:"Copy code block to Clipboard",onPress:o})),React.createElement(u,null,React.createElement(b,{label:React.createElement(U,{text:"Delete Rule",style:J.delete}),onPress:f})))}const{FormRow:K,FormArrow:X}=i.Forms;function Y(n){let{rule:c,index:e}=n;const r=t.NavigationNative.useNavigation();return React.createElement(K,{label:c.name,trailing:React.createElement(X,null),onPress:function(){return r.push("VendettaCustomPage",{title:"Editing Rule",render:function(){return React.createElement(w,{ruleIndex:e})}})}})}const{ScrollView:k,TextInput:q}=i.General,{FormRow:S,FormSection:C,FormDivider:Q}=i.Forms,I=t.stylesheet.createThemedStyleSheet({input:{fontSize:16,fontFamily:t.constants.Fonts.PRIMARY_MEDIUM,color:E.semanticColors.TEXT_NORMAL},placeholder:{color:E.semanticColors.INPUT_PLACEHOLDER_TEXT}}),W=p.findByName("useIsFocused");function Z(){const[n,c]=t.React.useState("");let e=s.storage.rules;v.useProxy(s.storage);const r=t.NavigationNative.useNavigation();W();const o=function(){n&&(e.push({name:n.trim(),match:"",flags:"gi",replace:"",regex:!1}),c(""),r.push("VendettaCustomPage",{title:"Editing Rule",render:function(){return t.React.createElement(w,{ruleIndex:e.length-1})}}))};return t.React.createElement(k,null,t.React.createElement(C,{title:"Rules"},e.map(function(f,l){return t.React.createElement(t.React.Fragment,null,t.React.createElement(Y,{rule:f,index:l}),t.React.createElement(Q,null))}),t.React.createElement(S,{label:t.React.createElement(q,{value:n,onChangeText:c,placeholder:"New rule",placeholderTextColor:I.placeholder.color,selectionColor:t.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:o,returnKeyType:"done",style:I.input}),trailing:t.React.createElement(j,{onPress:o})})),t.React.createElement(C,{title:"Sync Vencord TextReplace Rules"},t.React.createElement(S,{label:"HeLau1337's vendetta-text-replace"})))}let P;var ee={onLoad:function(){var n;(n=s.storage).rules??(n.rules=[]),P=[M(),A()]},onUnload:function(){for(const n of P)n()},settings:Z};return R.default=ee,Object.defineProperty(R,"__esModule",{value:!0}),R})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui.assets,vendetta.ui.components,vendetta.ui.toasts,vendetta.storage,vendetta.ui);
