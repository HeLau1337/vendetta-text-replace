(function(m,o,E,e,p,f,s,g,y,R){"use strict";const w=E.findByProps("openLazy","hideActionSheet"),{FormRow:A,FormIcon:D}=s.Forms,M=/^```(?:json)\n([\s\S]*?)```$/gm,C=f.getAssetIDByName("ic_download_24px");function V(){return p.before("openLazy",w,function(n){let[a,t]=n;t==="MessageLongPressActionSheet"&&a.then(function(r){const u=p.after("default",r,function(d,c){let[{message:b}]=d;e.React.useEffect(function(){return function(){u()}},[]);const F=b.content.match(M)?.map(function(l){return l.slice(7,l.length-3)}).map(function(l){try{return JSON.parse(l)}catch{return}}).filter(function(l){return l}).filter(function(l){return typeof l.name=="string"&&l.name&&typeof l.match=="string"&&typeof l.replace=="string"&&typeof l.flags=="string"&&typeof l.regex=="boolean"});if(!F||F.length==0)return;let ue=c?.props?.children?.props?.children?.props?.children[1];for(const l of F){const ie=function(){o.storage.rules.push(l),g.showToast(`Imported rule ${l.name}`,C),w.hideActionSheet()},de=e.React.createElement(A,{leading:e.React.createElement(D,{style:{opacity:1},source:C}),label:`Import ${l.name}`,onPress:ie});ue.unshift(de)}})})})}const B=E.findByProps("sendMessage","receiveMessage"),U=f.getAssetIDByName("ic_warning_24px");function z(){return p.before("sendMessage",B,function(n){const a=o.storage.rules.filter(function(r){return r.match});let t=n[1].content;for(const r of a)if(r.regex)try{const u=new RegExp(r.match,r.flags);t=t.replace(u,r.replace)}catch(u){console.log(u),g.showToast(`Failed to use RegExp for ${r.name}!`,U);continue}else t=t.replaceAll(r.match,r.replace);n[1].content=t})}const{TouchableOpacity:O}=s.General,{FormIcon:k}=s.Forms,G=f.getAssetIDByName("ic_add_24px");function j(n){let{onPress:a}=n;return React.createElement(O,{onPress:a},React.createElement(k,{source:G,style:{marginRight:-8,marginLeft:8,opacity:1}}))}const{ScrollView:J}=s.General,{FormSection:i,FormInput:h,FormDivider:x,FormSwitchRow:K,FormRow:N,FormLabel:X}=s.Forms,Y=f.getAssetIDByName("ic_message_copy"),q=e.stylesheet.createThemedStyleSheet({delete:{color:R.rawColors.RED_400}});function P(n){let{ruleIndex:a}=n,t=o.storage.rules[a];y.useProxy(o.storage);const r=e.NavigationNative.useNavigation(),u=function(){const c=`\`\`\`json
${JSON.stringify(t,null,4)}
\`\`\``;e.clipboard.setString(c),g.showToast(`Copied ${t.name} to Clipboard`,Y)},d=function(){o.storage.rules.splice(a,1),r.pop()};return React.createElement(J,null,React.createElement(i,null,React.createElement(h,{value:t?.name,onChange:function(c){return t.name=c},placeholder:"New rule",title:"Name"})),React.createElement(i,null,React.createElement(h,{value:t?.match,onChange:function(c){return t.match=c},placeholder:"foo",title:"Match"}),t?.regex&&React.createElement(React.Fragment,null,React.createElement(x,null),React.createElement(h,{title:"Flags",placeholder:"gi",value:t?.flags,onChange:function(c){return t.flags=c}})),React.createElement(x,null),React.createElement(h,{value:t?.replace,onChange:function(c){return t.replace=c},placeholder:"bar",title:"Replace with"})),React.createElement(i,null,React.createElement(K,{label:"Regular expression",subLabel:"Turn on if your rule is a regular expression",value:t?.regex,onValueChange:function(c){return t.regex=c}})),React.createElement(i,null,React.createElement(N,{label:"Copy code block to Clipboard",onPress:u})),React.createElement(i,null,React.createElement(N,{label:React.createElement(X,{text:"Delete Rule",style:q.delete}),onPress:d})))}const{FormRow:H,FormArrow:Q}=s.Forms;function W(n){let{rule:a,index:t}=n;const r=e.NavigationNative.useNavigation();return React.createElement(H,{label:a.name,trailing:React.createElement(Q,null),onPress:function(){return r.push("VendettaCustomPage",{title:"Editing Rule",render:function(){return React.createElement(P,{ruleIndex:t})}})}})}const{ScrollView:Z}=s.General,{FormSection:v,FormInput:ee,Button:S,FormDivider:fe,FormSwitchRow:te,FormRow:ge,FormLabel:Re}=s.Forms;e.stylesheet.createThemedStyleSheet({delete:{color:R.rawColors.RED_400}});function ne(){return{vencordSyncEnabled:!1,authenticated:!1,backendUrl:"https://api.vencord.dev/"}}function re(){let n=o.storage.vencordCloudSyncSettings??ne();return y.useProxy(o.storage),e.NavigationNative.useNavigation(),React.createElement(Z,null,React.createElement(v,null,React.createElement(te,{label:"Enable Cloud Integrations",subLabel:"This will request authorization if you have not yet set up cloud integrations.",value:n.vencordSyncEnabled,onValueChange:function(a){return n.vencordSyncEnabled=a}})),React.createElement(v,null,React.createElement(ee,{value:n.backendUrl,onChange:function(a){return n.backendUrl=a},title:"Backend URL"})),React.createElement(v,null,React.createElement(S,{sublabel:"This will overwrite your local settings with the ones on the cloud. Use wisely!",size:S.Sizes.SMALL,color:S.Colors.RED,disabled:!n.authenticated,onPress:function(){return g.showToast("Sync from Cloud was pressed but nothing happened yet.")}},"Sync from Cloud")))}const{ScrollView:ae,TextInput:le}=s.General,{FormRow:$,FormSection:I,FormDivider:T}=s.Forms,_=e.stylesheet.createThemedStyleSheet({input:{fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:R.semanticColors.TEXT_NORMAL},placeholder:{color:R.semanticColors.INPUT_PLACEHOLDER_TEXT}}),ce=E.findByName("useIsFocused");function oe(){const[n,a]=e.React.useState("");let t=o.storage.rules;y.useProxy(o.storage);const r=e.NavigationNative.useNavigation();ce();const u=function(){n&&(t.push({name:n.trim(),match:"",flags:"gi",replace:"",regex:!1}),a(""),r.push("VendettaCustomPage",{title:"Editing Rule",render:function(){return e.React.createElement(P,{ruleIndex:t.length-1})}}))},d=function(){r.push("VendettaCustomPage",{title:"Vencord TextReplace Cloud Sync",render:function(){return e.React.createElement(re,null)}})};return e.React.createElement(ae,null,e.React.createElement(I,{title:"Rules"},t.map(function(c,b){return e.React.createElement(e.React.Fragment,null,e.React.createElement(W,{rule:c,index:b}),e.React.createElement(T,null))}),e.React.createElement($,{label:e.React.createElement(le,{value:n,onChangeText:a,placeholder:"New rule",placeholderTextColor:_.placeholder.color,selectionColor:e.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:u,returnKeyType:"done",style:_.input}),trailing:e.React.createElement(j,{onPress:u})})),e.React.createElement(T,null),e.React.createElement(I,null,e.React.createElement($,{label:"Vencord TextReplace Cloud Sync Settings",onPress:d})))}let L;var se={onLoad:function(){var n;(n=o.storage).rules??(n.rules=[]),L=[z(),V()]},onUnload:function(){for(const n of L)n()},settings:oe};return m.default=se,Object.defineProperty(m,"__esModule",{value:!0}),m})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui.assets,vendetta.ui.components,vendetta.ui.toasts,vendetta.storage,vendetta.ui);
